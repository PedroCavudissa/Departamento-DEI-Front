
<div class="container">
  <h2>Lançamento de Notas</h2>

 
  <div class="mb-3">
    <button class="btn btn-secondary" (click)="resetar()">Limpar</button>
  </div>

  <div class="mb-3">
    <label for="disciplinaSelecionada">Disciplina:</label>
    <select [(ngModel)]="disciplinaSelecionada" id="disciplinaSelecionada" class="form-select">
      <option [value]="''">-- Selecione a disciplina --</option>
      <option *ngFor="let disc of disciplinas" [value]="disc.id">{{ disc.nome }}</option>
    </select>
  </div>

 
  <div class="mb-3">
    <label for="tipoSelecionado">Tipo de Nota:</label>
    <select [(ngModel)]="tipoSelecionado" id="tipoSelecionado" class="form-select">
      <option [value]="''">-- Selecione o tipo --</option>
      <option *ngFor="let tipo of tipos" [value]="tipo.id">
        {{ tipo.nome }}
      </option>
    </select>
  </div>

  <div class="botoes mb-4">
    <button 
      (click)="gerarExcel()" 
      [disabled]="!tipoSelecionado || !disciplinaSelecionada" 
      class="btn btn-primary me-2">
      Gerar Excel
    </button>

    <input 
      type="file" 
      (change)="onFileSelected($event)" 
      [disabled]="!tipoSelecionado || !disciplinaSelecionada" />
  </div>

  <div *ngIf="notas.length > 0">
    <h3>Notas Carregadas</h3>

    <table class="table table-striped">
      <thead>
        <tr>
          <th>Matrícula</th>
          <th>Aluno</th>
          <th *ngIf="tipoSelecionado === 1 || tipoSelecionado === 2">AC</th>
          <th *ngIf="tipoSelecionado === 1 || tipoSelecionado === 2">PF</th>
          <th>Nota Final</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let nota of notas; let i = index">
         
          <td *ngIf="tipoSelecionado === 1 || tipoSelecionado === 2">
            <input [(ngModel)]="notas[i].ac" type="number" class="form-control" />
          </td>
          <td *ngIf="tipoSelecionado === 1 || tipoSelecionado === 2">
            <input [(ngModel)]="notas[i].pf" type="number" class="form-control" />
          </td>
          <td>
            <input [(ngModel)]="notas[i].notaFinal" type="number" class="form-control" />
          </td>
        </tr>
      </tbody>
    </table>

   
    <div class="botoes mt-3">
      <button (click)="salvar()" class="btn btn-success me-2">Salvar</button>
      <button (click)="publicar()" class="btn btn-warning">Publicar</button>
    </div>
  </div>

  <div *ngIf="mensagem" class="alert alert-info mt-3">{{ mensagem }}</div>
</div>

<app-lateral-professor></app-lateral-professor>